VULNERABILITY_DATABASE = {
    "SUID_BINARIES": {
        "type": "SUID Binary Exploitation",
        "risk_level": "HIGH",
        "description": "SUID бинарники могут быть использованы для повышения привилегий",
        "techniques": [
            "/usr/bin/sudo - неправильная конфигурация",
            "/usr/bin/chmod - может изменять права доступа",
            "/usr/bin/chown - может менять владельца файлов",
            "/bin/mount - может монтировать файловые системы",
            "/usr/bin/passwd - может быть уязвим к уязвимостям шифрования"
        ],
        "mitigation": "Регулярно проверять SUID бинарники, использовать современные версии"
    },
    
    "SGID_BINARIES": {
        "type": "SGID Binary Exploitation",
        "risk_level": "MEDIUM",
        "description": "SGID файлы запускаются с правами группы владельца",
        "techniques": [
            "Поиск SGID бинарников с известными уязвимостями",
            "Манипуляция переменными окружения",
            "Race condition атаки"
        ],
        "mitigation": "Минимизировать количество SGID файлов, регулярные обновления"
    },
    
    "WORLD_WRITABLE_FILES": {
        "type": "World Writable File Exploitation",
        "risk_level": "CRITICAL",
        "description": "Файлы, доступные на запись для всех пользователей",
        "techniques": [
            "Модификация скриптов, запускаемых root",
            "Подмена конфигурационных файлов",
            "Создание symlink атак"
        ],
        "mitigation": "Удалить world-writable права с критичных файлов"
    },
    
    "WORLD_WRITABLE_DIRS": {
        "type": "World Writable Directory Exploitation",
        "risk_level": "CRITICAL",
        "description": "Директории, доступные на запись для всех",
        "techniques": [
            "Создание вредоносных файлов для последующего выполнения",
            "Symlink race condition",
            "Подмена libraries и конфигов"
        ],
        "mitigation": "Изменить права доступа, использовать sticky bit для /tmp"
    },
    
    "CRON_JOBS": {
        "type": "Cron Job Manipulation",
        "risk_level": "CRITICAL",
        "description": "Cron задачи, запускаемые с повышенными правами",
        "techniques": [
            "Модификация скриптов, используемых в cron",
            "PATH injection атаки",
            "Создание вредоносных файлов в cron директориях"
        ],
        "mitigation": "Контролировать права доступа к cron файлам и скриптам"
    },
    
    "SUDO_MISCONFIGURATION": {
        "type": "Sudo Misconfiguration",
        "risk_level": "CRITICAL",
        "description": "Неправильная конфигурация sudo может позволить повышение привилегий",
        "techniques": [
            "Запуск команд без пароля",
            "Использование wildcards в sudoers",
            "Обход проверок PATH",
            "LD_PRELOAD/LD_LIBRARY_PATH атаки"
        ],
        "mitigation": "Аудит /etc/sudoers, минимизация привилегий, использовать NOPASSWD с осторожностью"
    },
    
    "KERNEL_VULNERABILITIES": {
        "type": "Kernel Exploit",
        "risk_level": "CRITICAL",
        "description": "Уязвимости ядра Linux для локального повышения привилегий",
        "techniques": [
            "CVE эксплойты для конкретных версий ядра",
            "Race condition в системных вызовах",
            "Buffer overflow в ядре"
        ],
        "mitigation": "Обновлять ядро регулярно, использовать ASLR и DEP"
    },
    
    "CAPABILITIES": {
        "type": "Linux Capabilities Abuse",
        "risk_level": "HIGH",
        "description": "Неправильное использование capabilities может привести к повышению привилегий",
        "techniques": [
            "Поиск бинарников с cap_setuid",
            "Использование capabilities для выполнения привилегированных операций"
        ],
        "mitigation": "Минимизировать capabilities на бинарниках, регулярная проверка"
    },
    
    "ENVIRONMENT_VARIABLES": {
        "type": "Environment Variable Injection",
        "risk_level": "HIGH",
        "description": "Манипуляция переменными окружения для повышения привилегий",
        "techniques": [
            "LD_PRELOAD инъекция",
            "LD_LIBRARY_PATH перенаправление",
            "PATH manipulation",
            "IFS (Internal Field Separator) атаки"
        ],
        "mitigation": "Использовать абсолютные пути в скриптах, очищать окружение в SUID программах"
    }
}

# Словарь известных уязвимых бинарников
VULNERABLE_BINARIES = {
    "sudo": {"type": "SUID", "known_issues": ["Sudo версии < 1.9.5", "Nopasswd в sudoers"]},
    "chmod": {"type": "SUID", "known_issues": ["Может изменять права на любые файлы"]},
    "chown": {"type": "SUID", "known_issues": ["Может менять владельца любых файлов"]},
    "write": {"type": "SGID", "known_issues": ["SGID бит на tty"]},
    "mount": {"type": "SUID", "known_issues": ["Может монтировать системы файлов"]},
    "umount": {"type": "SUID", "known_issues": ["Может демонтировать системы файлов"]},
}

def get_vulnerability_info(vuln_type):
    """Получить информацию об уязвимости по типу"""
    return VULNERABILITY_DATABASE.get(vuln_type, {})

def check_binary_vulnerability(binary_name):
    """Проверить, известна ли уязвимость в бинарнике"""
    return VULNERABLE_BINARIES.get(binary_name, None)
